<!DOCTYPE html>
<html lang="en">
  <head>
    <base href="https://mealplan-calendar.com/" />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title property="pageTitle">MealPlan Calendar</title>
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.2/main.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.2/main.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" />
    <link rel="stylesheet" href="https://get.mavo.io/mavo.min.css" />
    <script src="https://get.mavo.io/mavo.min.js"></script>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f0f5f9;
      }
      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }
      h1 {
        color: #1e3a8a;
        text-align: center;
      }
      #calendar {
        background-color: white;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
      }
      .meal-card {
        background-color: white;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
      }
      .meal-card h2 {
        color: #1e3a8a;
      }
      .meal-photo {
        max-width: 100%;
        min-width: 100px;
        height: auto;
        border-radius: 5px;
      }
      .ingredients-list,
      .recipe-steps {
        list-style-type: none;
        padding-left: 0;
      }
      .ingredients-list li,
      .recipe-steps li {
        margin-bottom: 10px;
      }
      .buy-checklist {
        list-style-type: none;
        padding-left: 0;
      }
      .buy-checklist li {
        margin-bottom: 5px;
      }
      .buy-checklist input[type="checkbox"] {
        margin-right: 10px;
      }
      .meal-grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 20px;
      }
      @media (min-width: 768px) {
        .meal-grid {
          grid-template-columns: 1fr 1fr;
        }
      }
      .current-meal {
        background-color: #e6f7ff;
        border: 2px solid #1e90ff;
      }
      .current-meal h2 {
        color: #1e90ff;
      }
      .fc-event-title {
        font-size: 0.8em;
        white-space: normal;
      }
      .fc-event-time {
        display: none;
      }
      .fc-event {
        cursor: pointer;
      }
      .event-icon {
        margin-right: 5px;
      }
      .past-meal-item {
        border-bottom: 1px solid #e0e0e0;
        padding: 10px 0;
      }
    </style>
  </head>
  <body>
    <div
      mv-app="mealplanCalendar-bupcs3"
      mv-plugins="tinymce"
      mv-init="#initial"
      mv-storage="https://github.com/hsingh23/mealplan-calendar"
      mv-bar="no-login"
      autosave="3"
      mv-upload-path="pictures"
      class="mv-autoedit"
    >
      <div class="container">
        <h1 property="pageHeader">MealPlan Calendar</h1>
        <div id="calendar"></div>
        <div class="meal-grid">
          <div class="meal-card current-meal" id="current-meal" mv-list>
            <h2 property="currentMealHeader">Current Meal</h2>
            <div id="current-meal-info" mv-list-item property="currentMeal">
              <h3 property="title">Title:</h3>
              <p><strong>Description:</strong> <span property="description"></span></p>
              <img property="photo" class="meal-photo" />
              <h4>Ingredients:</h4>
              <ul class="ingredients-list" mv-list>
                <li mv-list-item="mealIngredients">
                  <span property="ingredient"></span>
                </li>
              </ul>
              <h4>Recipe:</h4>
              <ol class="recipe-steps" mv-list>
                <li mv-list-item="mealSteps">
                  <span property="step"></span>
                </li>
              </ol>
              <h4>Shopping Date:</h4>
              <input type="date" property="shopDate"></input>
              <h4>Preparation Date:</h4>
              <input type="date" property="prepDate"></input>
              <h4>Shopping List:</h4>
              <ul class="buy-checklist" mv-list>
                <li mv-list-item="currentMealShoppingList">
                  <input type="checkbox" id="[ingredient]" />
                  <label for="[ingredient]" property="ingredient"></label>
                </li>
              </ul>
            </div>
          </div>
          <div class="meal-card past-meals">
            <h2 property="pastMealsHeader">Past Meals</h2>
            <div id="past-meals-list" mv-list mv-accepts="currentMeal">
              <div class="past-meal-item" mv-list-item="pastMeals"><strong property="name"></strong> - <span property="date"></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script type="application/json" id="initial">
      {
        "pageHeader": "MealPlan Calendar",
        "currentMealHeader": "Current Meal",
        "mealDetailsHeader": "Meal Details",
        "pastMealsHeader": "Past Meals",
        "currentMeal": [
          {
            "title": "Grilled Lemon Herb Salmon",
            "description": "Delicious and healthy grilled salmon with a zesty lemon herb marinade.",
            "photo": "https://mealplan-calendar.com/images/lemon-herb-salmon.jpg",
            "mealIngredients": [
              { "ingredient": "4 salmon fillets" },
              { "ingredient": "2 lemons" },
              { "ingredient": "4 cloves garlic, minced" },
              { "ingredient": "2 tbsp fresh dill, chopped" },
              { "ingredient": "2 tbsp fresh parsley, chopped" },
              { "ingredient": "2 tbsp olive oil" },
              { "ingredient": "Salt and pepper to taste" }
            ],
            "mealSteps": [
              { "step": "In a bowl, mix lemon juice, minced garlic, dill, parsley, and olive oil." },
              { "step": "Season salmon fillets with salt and pepper." },
              { "step": "Marinate the salmon in the herb mixture for 30 minutes." },
              { "step": "Preheat grill to medium-high heat." },
              { "step": "Grill salmon for 4-5 minutes per side, or until cooked through." },
              { "step": "Serve with lemon wedges and extra herbs if desired." }
            ],
            "prepDate": "2023-05-20",
            "shopDate": "2023-05-19",
            "currentMealShoppingList": [
              { "ingredient": "4 salmon fillets" },
              { "ingredient": "2 lemons" },
              { "ingredient": "4 cloves garlic" },
              { "ingredient": "Fresh dill" },
              { "ingredient": "Fresh parsley" },
              { "ingredient": "Olive oil" },
              { "ingredient": "Salt and pepper" }
            ]
          }
        ],
        "pastMeals": [
          { "name": "Grilled Salmon", "date": "2023-05-10" },
          { "name": "Vegetable Lasagna", "date": "2023-05-05" },
          { "name": "Chicken Curry", "date": "2023-04-30" }
        ]
      }
    </script>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        var calendarEl = document.getElementById("calendar");
        var calendar = new FullCalendar.Calendar(calendarEl, {
          initialView: "dayGridMonth",
          events: [
            {
              title: "Shop: Spaghetti Bolognese",
              start: "2023-05-14",
              classNames: ["shop-event"],
              extendedProps: {
                icon: "fas fa-shopping-cart",
                mealName: "Spaghetti Bolognese",
                type: "shop",
              },
            },
            {
              title: "Prep: Spaghetti Bolognese",
              start: "2023-05-15",
              classNames: ["prep-event"],
              extendedProps: {
                icon: "fas fa-utensils",
                mealName: "Spaghetti Bolognese",
                type: "prep",
                description: "Classic Italian pasta dish with rich meat sauce.",
                photo: "https://mealplan-calendar.com/images/spaghetti-bolognese.jpg",
                ingredients: ["500g spaghetti", "400g ground beef", "400g crushed tomatoes", "1 onion", "2 cloves garlic", "Olive oil", "Salt", "Pepper", "Parmesan cheese"],
                recipe: [
                  "Boil spaghetti according to package instructions.",
                  "In a large pan, saut√© chopped onion and garlic in olive oil.",
                  "Add ground beef and cook until browned.",
                  "Add crushed tomatoes and simmer for 20 minutes.",
                  "Season with salt and pepper to taste.",
                  "Serve sauce over spaghetti and top with grated Parmesan.",
                ],
                shopDate: "2023-05-14",
              },
            },
            {
              title: "Shop: Chicken Stir Fry",
              start: "2023-05-17",
              classNames: ["shop-event"],
              extendedProps: {
                icon: "fas fa-shopping-cart",
                mealName: "Chicken Stir Fry",
                type: "shop",
              },
            },
            {
              title: "Prep: Chicken Stir Fry",
              start: "2023-05-18",
              classNames: ["prep-event"],
              extendedProps: {
                icon: "fas fa-utensils",
                mealName: "Chicken Stir Fry",
                type: "prep",
                description: "Quick and healthy vegetable stir fry with tender chicken pieces.",
                photo: "https://mealplan-calendar.com/images/chicken-stir-fry.jpg",
                ingredients: ["500g chicken breast", "Mixed vegetables (bell peppers, broccoli, carrots)", "Soy sauce", "Ginger", "Garlic", "Vegetable oil", "Rice"],
                recipe: [
                  "Cut chicken into bite-sized pieces.",
                  "Heat oil in a wok or large frying pan.",
                  "Stir-fry chicken until cooked through.",
                  "Add vegetables and stir-fry for 3-4 minutes.",
                  "Add minced ginger, garlic, and soy sauce.",
                  "Serve hot over steamed rice.",
                ],
                shopDate: "2023-05-17",
              },
            },
          ],
          eventContent: function (arg) {
            let icon = document.createElement("i");
            icon.className = arg.event.extendedProps.icon + " event-icon";

            let title = document.createElement("span");
            title.innerHTML = arg.event.extendedProps.type.charAt(0).toUpperCase() + arg.event.extendedProps.type.slice(1) + ": " + arg.event.extendedProps.mealName;

            let arrayOfDomNodes = [icon, title];
            return { domNodes: arrayOfDomNodes };
          },
          eventClick: function (info) {
            if (info.event.extendedProps.type === "prep") {
              displayMealDetails(info.event);
            }
          },
        });
        calendar.render();

        function displayMealDetails(event) {
          var mealInfo = document.getElementById("meal-info");
          var meal = event.extendedProps;
          var html = `
                    <h3>${meal.mealName}</h3>
                    <p><strong>Description:</strong> ${meal.description}</p>
                    <img src="${meal.photo}" alt="${meal.mealName}" class="meal-photo">
                    <h4>Ingredients:</h4>
                    <ul class="ingredients-list">
                        ${meal.ingredients.map((ingredient) => `<li>${ingredient}</li>`).join("")}
                    </ul>
                    <h4>Recipe:</h4>
                    <ol class="recipe-steps">
                        ${meal.recipe.map((step) => `<li>${step}</li>`).join("")}
                    </ol>
                    <h4>Shopping Date:</h4>
                    <p>${meal.shopDate}</p>
                    <h4>Preparation Date:</h4>
                    <p>${event.start.toISOString().split("T")[0]}</p>
                    <h4>Shopping List:</h4>
                    <ul class="buy-checklist">
                        ${meal.ingredients
                          .map(
                            (ingredient) => `
                            <li>
                                <input type="checkbox" id="${ingredient.replace(/\s+/g, "-")}">
                                <label for="${ingredient.replace(/\s+/g, "-")}">${ingredient}</label>
                            </li>
                        `
                          )
                          .join("")}
                    </ul>
                `;
          mealInfo.innerHTML = html;
        }
      });
    </script>
  </body>
</html>
